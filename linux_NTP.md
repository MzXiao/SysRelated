# linux ntp(netword protocol server)


## 1.Server 
### 1.1 what's  server
```
我们知道，服务器是一种特定的计算机，它通常作为网络的一个节点为来自网络不同地方的客户提供某种特定的服务；这里的“服务“其实就是一个具有特定功能的能持续
运行的计算机程序。传统意义上的服务器概念通常和物理意义上的计算机相等同。在具有多任务处理能力的现代操作下，一台计算机通常可以同时提供多个服务，那么
从”服务“的角度来看，这台计算机事实上扮演着多台服务器的角色，也可以说：它是多台”服务器“，而不仅仅是一台物理意义上的计算机；所有运行于其中的服务都能够
在操作系统的协调下合理地使用着计算机硬件软件资源。对服务器的理解进行重新定位：


服务器是一种具有特定功能的计算机程序，它以一台计算机作为运行的载体存在于网络的某个端点，能够通过网络同时为网络使用者持续不断地提供某种特定的服务。它更
是一种逻辑意义上的计算机，其物理意义上的计算机仅仅作为服务器的硬件形式而存在；一旦服务中止，服务器也将随之消失。服务器所需的资源是在操作系统的控制之下
受到其载体（硬件）的制约。一台计算机可同时提供多个服务，而形成多台虚拟的服务器框架。问题的来源：

任何的单台计算机的处理能力都是有限、无法扩展的，并且也不能保证其永不发生故障，硬件和软件故障都将直接导致（运行于其上的虚拟的）服务器的崩溃和服务的被
断。如何在硬件条件不改变的情况下，通过多计算机、多服务器提供服务的方式来协调、调动所有的系统资源，而提高整体的服务供应容量，同时消除因为单台服务器故而
导致的服务中断的隐患，服务器池化理念为这一问题带来了答案。
```

### 1.2 what's pool
```
池化从全新视角出发重新解释定义服务器资源的管理和分配机制，它采用面向服务、面向需求的系统资源分配方法来整合、改善和优化服务器的计算资源，以求达到提高整
体服务质量的目的。其解决问题的出发点在于：我们让一台计算机提供多个服务，同时也让某个服务由多台计算机提供；所有运行于不同计算机上的相同的服务（器）组成
一个虚拟的服务器池。

事实上，一个服务器池可以从广义上被理解为一台超级服务器，它的资源被分布在所有构建池的（多台）服务器之中。通过对服务器池的统一管理和操作，特别是对多台服
务器资源的均衡、协调和调度，最大限度地发挥和利用现有的计算资源；通过对池的伸缩性操作来调整服务器池（一台超级计算机）的处理能力，突破单台计算机的处理能
力的限制；同时，池系统所具有的强大的容错机制能够保证服务的持续不间断地提供。这种构建逻辑上的服务器池，并通过对池的统一管理、调度、均衡，并运用先进而
独到的容错机制，将多台冗余服务器整合成一台具有高可靠、高可扩展特性的超级服务器的过程，我们称之为服务器的“池化”。
```

### 1.3
```
核心思想
是让某项服务由多个冗余服务器同时来提供，所有这些服务器的集合被称为一个服务器池。也就是说：一项服务是由一个服务器池中的多台服务器的整体来提供，并且这些
服务器都通过各自的IP地址构建服务器池，因此没有地理位置的限制。存在于池中的多台服务器通过分布式的处理方式提高整体的处理能力，同时当其中一个服务器因故
障而不能继续提供服务的时候，可以由存在于服务器池中另一个正常运行的服务器继续提供。

服务器池是一个拥有着唯一标识名的逻辑概念，具有相同的服务功能的服务器以某一固定的标识名（被称为池名）在池监控服务器（我们称之为：池化器）处登记，并同时
接受它的管理监控，这样，就形成了一个服务器池。该技术提供了一种灵活有效的机制，来管理监控服务器池，统一调配、合理使用服务器池的系统资源。服务器池分别由
各自的服务器群组成。池化用户可以直接访问某个池，对于普通用户来说必须通过池化代理访问某个池所提供的服务。池中的服务器因为被池化，而组成一个整体，就好像
一台服务器那样面向用户提供服务，其中任何一台服务器的故障都不会影响服务的正常提供。
```

### 1.4.1
```
服务器池
由一个或多个服务器组成，我们称这些服务器为“池服务器或称池元”，它们是一组具有相同功能的，并被统一管理起来的逻辑意义上的服务器群体。这种包含多个冗余服
务器的池结构为切换服务和并行运算提供了可能；也就是说，中断的服务(比如：某一正在提供服务的服务器的故障而导致)可由存在于服务器池中的另一个服务器继续提
供。所有的服务器池都有其唯一的标识名，或称为“池名”。一个池名事实上指的就是一组服务器的集合。池服务器均以各自的IP地址动态分布于池中，它们是为用户提供
服务的实体。
```
### 1.4.2
```
池化器
是负责管理所有的池，是整个池架构的核心。一方面提供池名解析，以便池用户可以访问某一具体的服务器池；相对于传统的DNS服务，它能提供全动态、多个IP地址以及
多宿机IP地址的解析服务另一方面对所有服务器池进行实时的监控管理，可以及时识别新服务器加入、退出以及服务器故障<wbr>(软硬件故障或断电等)。
```
### 1.4.3
```
池用户
是使用服务器池所提供的某种服务的客户机。池用户通过在池化器解析某一池名，才能得到某一池服务器的具体IP地址，这样池用户才可以通过此IP地址访问某一池服
器。与传统的C/S模式不同的是：在池用户和池服务器建立的物理连接的同时还存在着一个和池建立的逻辑连接，物理连接可能会中断，但只要和池保持着逻辑上的连接，
就可以非常迅速地重新和另一个池服务器建立另一个连接。

该技术可用于几乎所有对高可靠性有较高要求的、基于IP网的领域，比如：有线和无线通信、网络电话、医疗、电子商业以及工业控制等领域。通常，在这样的应用中，
短暂的中断会给服务提供商带来巨大的经济和信誉上的损失。同时因其特殊的系统架构还为分布式计算、网格运算提供了良好可靠的平台。
```




## 2 NTP(Network Time Protocol)

### 2.1 time server architecture
```
*Statum0*
*Statum1* *Statum1*
*Statum2* *Statum2* *Statum2*
*Statum3* *Statum3* *Statum3* *Statum3*

Statum1 : 主服务器
Statum2 Statum3 ：辅助服务器
Statum4 --- ： 客户服务器

```
### 2.2 config  ntp  server
```sh
[install ntp]
sudo apt update -y
sudo apt install ntp 
sntp --version

[config ntp server]
find Statum server [min3 -7]
sudo vim /etc/ntp.conf
server 0 ***.ntp.org iburst
server 1
server 2
...

[restart ntp]
sudo systemctl restart ntp
sudo systemctl status ntp

[firewall]
sudo ufw allow ntp      sudo ufw allow 123/udp 
sudo ufw reload
sudo ufw status

```


### 2.3 ntp client
```sh
sudo apt install ntpdate

sudo vim /etc/hosts
[add ip NTP-server-hostname]

sudo ntpdate NTP-server-hostname

sudo timedatectl set-ntp off

sudo systemctl restart ntp

ntpq -p

```







